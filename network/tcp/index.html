<!doctype html><html lang=zh-cn>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>TCP协议总结 - Jekst</title><link rel=apple-touch-icon href=/images/favicons/apple-touch-icon.png sizes=180x180>
<link rel=icon href=/images/favicons/favicon-32x32.png sizes=32x32 type=image/png>
<link rel=icon href=/images/favicons/favicon-16x16.png sizes=16x16 type=image/png>
<link rel=manifest href=/images/favicons/manifest.json>
<link rel=icon href=/images/favicons/favicon.ico>
<meta name=keywords content>
<meta name=description content><meta itemprop=name content="TCP协议总结">
<meta itemprop=description content="传输控制协议（Transmission Control Protocol，TCP）是一种面向连接的、可靠的、基于字节流的传输层通信协议，
1.TCP特点  TCP时面向连接的传输层协议。 TCP只支持一对一通信。 TCP提供可靠交付的服务。通过TCP传送的数据，无差错、不丢失、不重复、并且按序到达。 TCP提供全双工通信。 TCP是面向字节流的。  为满足TCP协议的这些特点，TCP协议做了如下的规定：
①数据分片：在发送端对用户数据进行分片，在接收端进行重组，由TCP确定分片的大小并控制分片和重组；
②到达确认：接收端接收到分片数据时，根据分片数据序号向发送端发送一个确认；
③超时重发：发送方在发送分片时启动超时定时器，如果在定时器超时之后没有收到相应的确认，重发分片；
④滑动窗口：TCP连接每一方的接收缓冲空间大小都固定，接收端只允许另一端发送接收端缓冲区所能接纳的数据，TCP在滑动窗口的基础上提供流量控制，防止较快主机致使较慢主机的缓冲区溢出；
⑤失序处理：作为IP数据报来传输的TCP分片到达时可能会失序，TCP将对收到的数据进行重新排序，将收到的数据以正确的顺序交给应用层；
⑥重复处理：作为IP数据报来传输的TCP分片会发生重复，TCP的接收端必须丢弃重复的数据；
⑦数据校验：TCP将保持它首部和数据的检验和，这是一个端到端的检验和，目的是检测数据在传输过程中的任何变化。如果收到分片的检验和有差错，TCP将丢弃这个分片，并不确认收到此报文段导致对端超时并重发。
2.TCP首部格式    0 1 2 3 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Source Port | Destination Port | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Sequence Number | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Acknowledgment Number | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Data | |U|A|P|R|S|F| | | Offset| Reserved |R|C|S|S|Y|I| Window | | | |G|K|H|T|N|N| | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Checksum | Urgent Pointer | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Options | Padding | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | data | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   Source Port是源端口，16位。 Destination Port是目的端口，16位。 Sequence Number是发送数据包中的第一个字节的序列号，32位。 Acknowledgment Number是确认序列号，32位。 Data Offset是数据偏移，4位，该字段的值是TCP首部（包括选项）长度除以4。 标志位： 6位，URG表示Urgent Pointer字段有意义： ACK表示Acknowledgment Number字段有意义 PSH表示Push功能，RST表示复位TCP连接 SYN表示SYN报文（在建立TCP连接的时候使用） FIN表示没有数据需要发送了（在关闭TCP连接的时候使用） Window表示接收缓冲区的空闲空间，16位，用来告诉TCP连接对端自己能够接收的最大数据长度。 Checksum是校验和，16位。 Urgent Pointers是紧急指针，16位，只有URG标志位被设置时该字段才有意义，表示紧急数据相对序列号（Sequence Number字段的值）的偏移。  3."><meta itemprop=datePublished content="2021-09-05T00:00:00+00:00">
<meta itemprop=dateModified content="2021-09-05T00:00:00+00:00">
<meta itemprop=wordCount content="157">
<meta itemprop=keywords content="TCP,"><meta property="og:title" content="TCP协议总结">
<meta property="og:description" content="传输控制协议（Transmission Control Protocol，TCP）是一种面向连接的、可靠的、基于字节流的传输层通信协议，
1.TCP特点  TCP时面向连接的传输层协议。 TCP只支持一对一通信。 TCP提供可靠交付的服务。通过TCP传送的数据，无差错、不丢失、不重复、并且按序到达。 TCP提供全双工通信。 TCP是面向字节流的。  为满足TCP协议的这些特点，TCP协议做了如下的规定：
①数据分片：在发送端对用户数据进行分片，在接收端进行重组，由TCP确定分片的大小并控制分片和重组；
②到达确认：接收端接收到分片数据时，根据分片数据序号向发送端发送一个确认；
③超时重发：发送方在发送分片时启动超时定时器，如果在定时器超时之后没有收到相应的确认，重发分片；
④滑动窗口：TCP连接每一方的接收缓冲空间大小都固定，接收端只允许另一端发送接收端缓冲区所能接纳的数据，TCP在滑动窗口的基础上提供流量控制，防止较快主机致使较慢主机的缓冲区溢出；
⑤失序处理：作为IP数据报来传输的TCP分片到达时可能会失序，TCP将对收到的数据进行重新排序，将收到的数据以正确的顺序交给应用层；
⑥重复处理：作为IP数据报来传输的TCP分片会发生重复，TCP的接收端必须丢弃重复的数据；
⑦数据校验：TCP将保持它首部和数据的检验和，这是一个端到端的检验和，目的是检测数据在传输过程中的任何变化。如果收到分片的检验和有差错，TCP将丢弃这个分片，并不确认收到此报文段导致对端超时并重发。
2.TCP首部格式    0 1 2 3 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Source Port | Destination Port | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Sequence Number | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Acknowledgment Number | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Data | |U|A|P|R|S|F| | | Offset| Reserved |R|C|S|S|Y|I| Window | | | |G|K|H|T|N|N| | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Checksum | Urgent Pointer | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Options | Padding | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | data | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   Source Port是源端口，16位。 Destination Port是目的端口，16位。 Sequence Number是发送数据包中的第一个字节的序列号，32位。 Acknowledgment Number是确认序列号，32位。 Data Offset是数据偏移，4位，该字段的值是TCP首部（包括选项）长度除以4。 标志位： 6位，URG表示Urgent Pointer字段有意义： ACK表示Acknowledgment Number字段有意义 PSH表示Push功能，RST表示复位TCP连接 SYN表示SYN报文（在建立TCP连接的时候使用） FIN表示没有数据需要发送了（在关闭TCP连接的时候使用） Window表示接收缓冲区的空闲空间，16位，用来告诉TCP连接对端自己能够接收的最大数据长度。 Checksum是校验和，16位。 Urgent Pointers是紧急指针，16位，只有URG标志位被设置时该字段才有意义，表示紧急数据相对序列号（Sequence Number字段的值）的偏移。  3.">
<meta property="og:type" content="article">
<meta property="og:url" content="/network/tcp/"><meta property="article:section" content="network">
<meta property="article:published_time" content="2021-09-05T00:00:00+00:00">
<meta property="article:modified_time" content="2021-09-05T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="TCP协议总结">
<meta name=twitter:description content="传输控制协议（Transmission Control Protocol，TCP）是一种面向连接的、可靠的、基于字节流的传输层通信协议，
1.TCP特点  TCP时面向连接的传输层协议。 TCP只支持一对一通信。 TCP提供可靠交付的服务。通过TCP传送的数据，无差错、不丢失、不重复、并且按序到达。 TCP提供全双工通信。 TCP是面向字节流的。  为满足TCP协议的这些特点，TCP协议做了如下的规定：
①数据分片：在发送端对用户数据进行分片，在接收端进行重组，由TCP确定分片的大小并控制分片和重组；
②到达确认：接收端接收到分片数据时，根据分片数据序号向发送端发送一个确认；
③超时重发：发送方在发送分片时启动超时定时器，如果在定时器超时之后没有收到相应的确认，重发分片；
④滑动窗口：TCP连接每一方的接收缓冲空间大小都固定，接收端只允许另一端发送接收端缓冲区所能接纳的数据，TCP在滑动窗口的基础上提供流量控制，防止较快主机致使较慢主机的缓冲区溢出；
⑤失序处理：作为IP数据报来传输的TCP分片到达时可能会失序，TCP将对收到的数据进行重新排序，将收到的数据以正确的顺序交给应用层；
⑥重复处理：作为IP数据报来传输的TCP分片会发生重复，TCP的接收端必须丢弃重复的数据；
⑦数据校验：TCP将保持它首部和数据的检验和，这是一个端到端的检验和，目的是检测数据在传输过程中的任何变化。如果收到分片的检验和有差错，TCP将丢弃这个分片，并不确认收到此报文段导致对端超时并重发。
2.TCP首部格式    0 1 2 3 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Source Port | Destination Port | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Sequence Number | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Acknowledgment Number | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Data | |U|A|P|R|S|F| | | Offset| Reserved |R|C|S|S|Y|I| Window | | | |G|K|H|T|N|N| | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Checksum | Urgent Pointer | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Options | Padding | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | data | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   Source Port是源端口，16位。 Destination Port是目的端口，16位。 Sequence Number是发送数据包中的第一个字节的序列号，32位。 Acknowledgment Number是确认序列号，32位。 Data Offset是数据偏移，4位，该字段的值是TCP首部（包括选项）长度除以4。 标志位： 6位，URG表示Urgent Pointer字段有意义： ACK表示Acknowledgment Number字段有意义 PSH表示Push功能，RST表示复位TCP连接 SYN表示SYN报文（在建立TCP连接的时候使用） FIN表示没有数据需要发送了（在关闭TCP连接的时候使用） Window表示接收缓冲区的空闲空间，16位，用来告诉TCP连接对端自己能够接收的最大数据长度。 Checksum是校验和，16位。 Urgent Pointers是紧急指针，16位，只有URG标志位被设置时该字段才有意义，表示紧急数据相对序列号（Sequence Number字段的值）的偏移。  3.">
<meta data-name=palette content="blue"><link rel=preload href=/css/bundle.min.584ad61bfb9121e174610ca0716e7303fbd4708cb91ca3f4b802d8d6d4745f84.css integrity="sha256-WErWG/uRIeF0YQygcW5zA/vUcIy5HKP0uALY1tR0X4Q=" crossorigin=anonymous as=style onload="this.rel='stylesheet'">
<noscript><link rel=stylesheet href=/css/bundle.min.584ad61bfb9121e174610ca0716e7303fbd4708cb91ca3f4b802d8d6d4745f84.css integrity="sha256-WErWG/uRIeF0YQygcW5zA/vUcIy5HKP0uALY1tR0X4Q=" crossorigin=anonymous></noscript><script src=/js/bundle.min.363c0003fd4dc83d43b6e5f6d26613738781f3995a2f895af4a82c77f44ce9c7.js integrity="sha256-NjwAA/1NyD1DtuX20mYTc4eB85laL4la9Kgsd/RM6cc=" crossorigin=anonymous></script>
</head><body><header><nav class="navbar navbar-expand-xl fixed-top">
<div class=container>
<a class=navbar-brand href=/>
<img class=logo alt=Logo src=/images/logo.png width=128 height=128 loading=lazy>
Jekst</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav me-1 mb-2 mb-lg-0"><form class="search-bar d-flex ms-1" action=/search>
<div class="input-group input-group-sm">
<button class="btn btn-search disabled position-absolute left-0" type=submit aria-label=submit><i class="fas fa-fw fa-search"></i></button>
<input class="form-control rounded-pill" id=searchQuery name=q type=search aria-label=Search>
</div>
</form></ul><ul class="navbar-nav me-1 mb-2 mb-lg-0 me-1 ms-auto"><li class=nav-item>
<a class=nav-link href=/design-pattern/>
设计模式
</a>
</li><li class=nav-item>
<a class=nav-link href=/network/>
计算机网络
</a>
</li><li class=nav-item>
<a class=nav-link href=/os/>
操作系统
</a>
</li><li class=nav-item>
<a class=nav-link href=/programming/>
编程开发
</a>
</li><li class=nav-item>
<a class=nav-link href=/categories/>
分类
</a>
</li><li class=nav-item>
<a class=nav-link href=/archives/>
归档
</a>
</li><li class=nav-item>
<a class=nav-link data-bs-toggle=offcanvas href=#offcanvasSettings role=button aria-controls=offcanvasSettings>
<i class="fas fa-fw fa-sliders-h"></i> 设置
</a>
</li>
<div class="offcanvas offcanvas-end surface h-100" tabindex=-1 id=offcanvasSettings aria-labelledby=offcanvasSettingsLabel>
<div class=offcanvas-header>
<h5 class=offcanvas-title w id=offcanvasSettingsLabel><i class="fas fa-fw fa-sliders-h"></i> 设置</h5>
<a role=button data-bs-dismiss=offcanvas aria-label=Close>
<span class="fas fa-2x fa-fw fa-times"></span>
</a>
</div>
<div class=offcanvas-body><section class=setting>
<form class=row>
<div class=col-auto>
<label><i class="fas fa-fw fa-adjust"></i> 模式</label>
</div>
<div class="col-auto ms-auto">
<div class="form-check form-switch">
<input class=form-check-input type=checkbox id=modeSwitcher>
</div>
</div>
</form>
</section>
<section class=setting>
<form class="font-size-switcher-form row">
<div class=col-auto>
<label for=fontSize class=form-label><i class="fas fa-fw fa-font"></i> 字体大小</label>
</div>
<div class="col-auto ms-auto">
<input type=range class=form-range min=-2 max=2 id=fontSize>
</div>
</form>
</section>
<section class="setting palettes">
<form class=row>
<div class=col-auto>
<label><i class="fas fa-fw fa-palette"></i> 配色</label>
</div>
<div class="col-auto ms-auto">
<span id=btnPalette class="btn btn-sm"><i class="fas fa-eye-dropper"></i></span>
</div>
</form>
<div class="container mt-2 visually-hidden" id=palettePicker>
<div class=btn-group><button type=button id=palette-blue title=蓝色 class="btn btn-sm palette bg-blue d-flex align-items-center justify-content-center">
</button><button type=button id=palette-blue-gray title=蓝灰色 class="btn btn-sm palette bg-blue-gray d-flex align-items-center justify-content-center">
</button><button type=button id=palette-brown title=棕色 class="btn btn-sm palette bg-brown d-flex align-items-center justify-content-center">
</button><button type=button id=palette-cyan title=青色 class="btn btn-sm palette bg-cyan d-flex align-items-center justify-content-center">
</button><button type=button id=palette-green title=绿色 class="btn btn-sm palette bg-green d-flex align-items-center justify-content-center">
</button><button type=button id=palette-indigo title=靛青色 class="btn btn-sm palette bg-indigo d-flex align-items-center justify-content-center">
</button><button type=button id=palette-orange title=橙色 class="btn btn-sm palette bg-orange d-flex align-items-center justify-content-center">
</button><button type=button id=palette-pink title=粉色 class="btn btn-sm palette bg-pink d-flex align-items-center justify-content-center">
</button><button type=button id=palette-purple title=紫色 class="btn btn-sm palette bg-purple d-flex align-items-center justify-content-center">
</button><button type=button id=palette-red title=红色 class="btn btn-sm palette bg-red d-flex align-items-center justify-content-center">
</button><button type=button id=palette-teal title=蓝绿色 class="btn btn-sm palette bg-teal d-flex align-items-center justify-content-center">
</button><button type=button id=palette-yellow title=黄色 class="btn btn-sm palette bg-yellow d-flex align-items-center justify-content-center">
</button></button>
</div>
</div>
</section></div>
</div></ul>
</div>
</div>
</nav>
</header>
<main role=main class=container>
<div class="row content">
<div class=col-lg-8>
<div class=container><nav class=row aria-label=breadcrumb>
<ol class="breadcrumb surface"><li class=breadcrumb-item><a href=/>主页</a></li><li class=breadcrumb-item><a href=/network/>计算机网络</a></li><li class="breadcrumb-item active">TCP协议总结</li></ol>
</nav><article class="post row surface"><div class=post-panel-wrapper>
<div class="post-panel d-flex flex-column">
</div>
</div>
<h1 class="post-title my-3">TCP协议总结
</h1><div class="post-meta mb-3"><span class="post-date me-2">
<i class="fas fa-fw fa-calendar-alt"></i>2021-09-05
</span><span class="post-reading-time me-2">
<i class="fas fa-fw fa-coffee"></i>1 分钟阅读
</span><span class=post-taxonomies><a href=/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/ class=post-taxonomy>计算机网络</a><a href=/tags/tcp/ class=post-taxonomy>TCP</a></span>
</div>
<div class="post-content mb-3"><p>传输控制协议（Transmission Control Protocol，TCP）是一种面向连接的、可靠的、基于字节流的传输层通信协议，</p>
<h4 id=1tcp特点>1.TCP特点</h4>
<ol>
<li>TCP时面向连接的传输层协议。</li>
<li>TCP只支持一对一通信。</li>
<li>TCP提供可靠交付的服务。通过TCP传送的数据，无差错、不丢失、不重复、并且按序到达。</li>
<li>TCP提供全双工通信。</li>
<li>TCP是面向字节流的。</li>
</ol>
<p>为满足TCP协议的这些特点，TCP协议做了如下的规定：</p>
<p>①数据分片：在发送端对用户数据进行分片，在接收端进行重组，由TCP确定分片的大小并控制分片和重组；</p>
<p>②到达确认：接收端接收到分片数据时，根据分片数据序号向发送端发送一个确认；</p>
<p>③超时重发：发送方在发送分片时启动超时定时器，如果在定时器超时之后没有收到相应的确认，重发分片；</p>
<p>④滑动窗口：TCP连接每一方的接收缓冲空间大小都固定，接收端只允许另一端发送接收端缓冲区所能接纳的数据，TCP在滑动窗口的基础上提供流量控制，防止较快主机致使较慢主机的缓冲区溢出；</p>
<p>⑤失序处理：作为IP数据报来传输的TCP分片到达时可能会失序，TCP将对收到的数据进行重新排序，将收到的数据以正确的顺序交给应用层；</p>
<p>⑥重复处理：作为IP数据报来传输的TCP分片会发生重复，TCP的接收端必须丢弃重复的数据；</p>
<p>⑦数据校验：TCP将保持它首部和数据的检验和，这是一个端到端的检验和，目的是检测数据在传输过程中的任何变化。如果收到分片的检验和有差错，TCP将丢弃这个分片，并不确认收到此报文段导致对端超时并重发。</p>
<h4 id=2tcp首部格式>2.TCP首部格式</h4>
<blockquote>
</blockquote>
<pre><code>     0                   1                   2                   3
	0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|          Source Port          |       Destination Port        |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|                        Sequence Number                        |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|                    Acknowledgment Number                      |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|  Data |           |U|A|P|R|S|F|                               |
	| Offset| Reserved  |R|C|S|S|Y|I|            Window             |
	|       |           |G|K|H|T|N|N|                               |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|           Checksum            |         Urgent Pointer        |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|                    Options                    |    Padding    |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|                             data                              |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>
<ol>
<li>Source Port是源端口，16位。</li>
<li>Destination Port是目的端口，16位。</li>
<li>Sequence Number是发送数据包中的第一个字节的序列号，32位。</li>
<li>Acknowledgment Number是确认序列号，32位。</li>
<li>Data Offset是数据偏移，4位，该字段的值是TCP首部（包括选项）长度除以4。</li>
<li>标志位： 6位，URG表示Urgent Pointer字段有意义：
ACK表示Acknowledgment Number字段有意义
PSH表示Push功能，RST表示复位TCP连接
SYN表示SYN报文（在建立TCP连接的时候使用）
FIN表示没有数据需要发送了（在关闭TCP连接的时候使用）
Window表示接收缓冲区的空闲空间，16位，用来告诉TCP连接对端自己能够接收的最大数据长度。</li>
<li>Checksum是校验和，16位。</li>
<li>Urgent Pointers是紧急指针，16位，只有URG标志位被设置时该字段才有意义，表示紧急数据相对序列号（Sequence Number字段的值）的偏移。</li>
</ol>
<h4 id=3建立连接>3.建立连接</h4>
<p>TCP使用三次握手协议建立连接。当主动方发出SYN连接请求后，等待对方回答SYN+ACK，并最终对对方的 SYN 执行 ACK 确认。这种建立连接的方法可以防止产生错误的连接。</p>
<p>TCP三次握手的过程如下：</p>
<ol>
<li>客户端发送SYN（SEQ=x）报文给服务器端，进入SYN_SEND状态。</li>
<li>服务器端收到SYN报文，回应一个SYN （SEQ=y）ACK（ACK=x+1）报文，进入SYN_RECV状态。</li>
<li>客户端收到服务器端的SYN报文，回应一个ACK（ACK=y+1）报文，进入Established状态。</li>
</ol>
<p>三次握手完成，TCP客户端和服务器端成功地建立连接，可以开始传输数据了。</p>
<h4 id=4断开连接>4.断开连接</h4>
<p>建立一个连接需要三次握手，而终止一个连接要经过四次握手，这是由TCP的半关闭（half-close）造成的。具体过程如下：</p>
<ol>
<li>某个应用进程首先调用close，称该端执行“主动关闭”（active close）。该端的TCP于是发送一个FIN分节，表示数据发送完毕。</li>
<li>接收到这个FIN的对端执行 “被动关闭”（passive close），这个FIN由TCP确认。
注意：FIN的接收也作为一个文件结束符（end-of-file）传递给接收端应用进程，放在已排队等候该应用进程接收的任何其他数据之后，因为，FIN的接收意味着接收端应用进程在相应连接上再无额外数据可接收。</li>
<li>一段时间后，接收到这个文件结束符的应用进程将调用close关闭它的套接字。这导致它的TCP也发送一个FIN。</li>
<li>接收这个最终FIN的原发送端TCP（即执行主动关闭的那一端）确认这个FIN。</li>
</ol>
<p>既然每个方向都需要一个FIN和一个ACK，因此通常需要4个分节。
注意：</p>
<ol>
<li>“通常”是指，某些情况下，步骤1的FIN随数据一起发送，另外，步骤2和步骤3发送的分节都出自执行被动关闭那一端，有可能被合并成一个分节。</li>
<li>在步骤2与步骤3之间，从执行被动关闭一端到执行主动关闭一端流动数据是可能的，这称为“半关闭”（half-close）。</li>
<li>当一个Unix进程无论自愿地（调用exit或从main函数返回）还是非自愿地（收到一个终止本进程的信号）终止时，所有打开的描述符都被关闭，这也导致仍然打开的任何TCP连接上也发出一个FIN。</li>
</ol>
<p>无论是客户还是服务器，任何一端都可以执行主动关闭。通常情况是，客户执行主动关闭，但是某些协议，例如，HTTP/1.0却由服务器执行主动关闭。</p>
</div><hr><div class="post-navs d-flex mb-3 justify-content-between">
<div class="post-nav w-50"><div class="prev-post btn btn-sm">
<a href=/network/udp/>UDP协议总结
</a>
</div></div>
<div class="post-nav flex-row-reverse"><div class="next-post btn btn-sm">
<a href=/posts/markdown-syntax/>Markdown简明教程
</a>
</div></div>
</div><section class=related-posts>
<h3>相关文章</h3>
<ul class=related-posts><li><a href=/network/udp/>UDP协议总结
</a></li><li><a href=/network/http-code/>HTTP响应码
</a></li><li><a href=/programming/brew/>Brew阿里源配置
</a></li><li><a href=/programming/docker-webservice/>Docker Webservice
</a></li><li><a href=/programming/docker-registry/>Docker阿里云镜像配置
</a></li></ul>
</section></article></div>
</div><aside class="col-lg-4 sidebar d-flex">
<div class=container><section class="recent-posts row surface">
<h4>最近文章</h4>
<ul><li><a href=/programming/brew/>Brew阿里源配置
</a></li><li><a href=/programming/docker-webservice/>Docker Webservice
</a></li><li><a href=/programming/docker-registry/>Docker阿里云镜像配置
</a></li><li><a href=/programming/gitconfig/>Git常用配置
</a></li><li><a href=/programming/goconfig/>Golang配置
</a></li></ul>
</section><section class="taxonomy-categories row surface">
<h4>
<a href=/categories>分类</a>
</h4>
<div><a href=/categories/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=编程开发>
编程开发 <span class="badge rounded-pill">7</span>
</a><a href=/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=计算机网络>
计算机网络 <span class="badge rounded-pill">3</span>
</a><a href=/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=操作系统>
操作系统 <span class="badge rounded-pill">1</span>
</a><a href=/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=设计模式>
设计模式 <span class="badge rounded-pill">1</span>
</a></div>
</section><section class="taxonomy-tags row surface">
<h4>
<a href=/tags>标签</a>
</h4>
<div><a href=/tags/docker/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Docker>
Docker <span class="badge rounded-pill">3</span>
</a><a href=/tags/golang/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Golang>
Golang <span class="badge rounded-pill">2</span>
</a><a href=/tags/http/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=HTTP>
HTTP <span class="badge rounded-pill">2</span>
</a><a href=/tags/brew/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Brew>
Brew <span class="badge rounded-pill">1</span>
</a><a href=/tags/git/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Git>
Git <span class="badge rounded-pill">1</span>
</a><a href=/tags/markdown/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Markdown>
Markdown <span class="badge rounded-pill">1</span>
</a><a href=/tags/tcp/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=TCP>
TCP <span class="badge rounded-pill">1</span>
</a><a href=/tags/udp/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=UDP>
UDP <span class="badge rounded-pill">1</span>
</a><a href=/tags/zsh/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Zsh>
Zsh <span class="badge rounded-pill">1</span>
</a></div>
</section></div>
</aside>
</div>
</main><footer class="footer mt-auto py-3 text-center container"><div class="copyright mb-2">
Copyright © 2016-2021 Jekst. All Rights Reserved.
</div>
<div class="powered-by mb-2">
Powered by <a href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> and the <a href=https://github.com/razonyang/hugo-theme-bootstrap target=_blank rel="noopener noreferrer">Bootstrap</a> theme.
</div></footer>
<a id=btnScrollToTop class=btn-scroll-to-top>
<i class="fas fa-fw fa-chevron-circle-up fa-2x"></i>
</a>
</body>
</html>